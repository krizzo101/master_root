---
# SYSTEM AUDIT WORKFLOW

expectation: validated_system_audit_report_and_evidence
max_parallelism: true
batching_enabled: true
plan_ahead: true
combine_and_chain_steps: true
completion: system_audit_report_and_evidence_in_standard_locations

phases:
  planning:
    description: |
      Define audit scope, objectives, and schedule. Gather initial context and
      stakeholders.
    steps:
      - define_scope_and_objectives
      - identify_stakeholders
      - schedule_audit
    gates:
      - scope_and_objectives_defined
      - stakeholders_identified
      - audit_scheduled

  risk_assessment:
    description: |
      Identify and prioritize risks to guide audit focus.
    steps:
      - gather_system_information
      - perform_risk_analysis
      - prioritize_audit_targets
    gates:
      - system_information_gathered
      - risks_prioritized

  controls_evaluation:
    description: |
      Evaluate internal controls and safeguards.
    steps:
      - review_access_controls
      - assess_change_management
      - evaluate_backup_and_recovery
      - inspect_data_classification_and_retention
    gates:
      - controls_evaluated

  compliance_review:
    description: |
      Compare practices against compliance standards (NIST, ISO, SOC2, etc.).
    steps:
      - map_controls_to_standards
      - document_compliance_gaps
    gates:
      - compliance_gaps_documented

  vulnerability_testing:
    description: |
      Run automated tools and manual tests to identify vulnerabilities.
    steps:
      - run_open_source_audit_tools
      - perform_manual_testing
      - collect_evidence
    gates:
      - vulnerabilities_identified
      - evidence_collected

  reporting:
    description: |
      Synthesize findings, evidence, and recommendations into a detailed report.
    steps:
      - draft_audit_report
      - review_and_validate_report
      - finalize_and_save_report
    gates:
      - audit_report_finalized

  follow_up:
    description: |
      Verify remediation and continuous monitoring.
    steps:
      - verify_remediation_actions
      - schedule_continuous_monitoring
    gates:
      - remediation_verified
      - monitoring_scheduled

validation_criteria:
  - all_phases_completed
  - evidence_collected_and_documented
  - report_meets_output_template
  - compliance_gaps_identified
  - recommendations_provided
  - follow_up_actions_defined

agent_profile: .cursor/profiles/system_audit_agent_profile.yml
output_template: .cursor/templates/system_audit_output_template.yml
