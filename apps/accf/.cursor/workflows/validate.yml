# VALIDATION WORKFLOW - OPERATIONALIZED DEPENDENCY ANALYSIS

trigger_keywords: [validate, check, verify, analyze]

phases:
  dependency_validation:
    description: "Automatic dependency analysis and change impact assessment"
    operations:
      - command: "python scripts/dependency_mapper.py --format summary"
        explanation: "Generate comprehensive dependency analysis"
      - command: "python scripts/comprehensive_project_scanner.py"
        explanation: "Execute project-wide validation scan"

      - command: "git diff --name-only HEAD~1 HEAD | xargs -I {} python scripts/dependency_mapper.py --check-file {}"
        purpose: "Analyze impact of recent changes"

      - tool: "dependency_consistency_check"
        description: "Validate all references are intact"
        check_types: ["protocol_references", "rule_references", "workflow_dependencies"]

  external_tool_validation:
    description: "Leverage external dependency tools for comprehensive analysis"
    operations:
      - tool: "check_tool_availability"
        tools: ["madge", "dependency-cruiser", "skott"]
        auto_install: false

      - tool: "conditional_execution"
        condition: "madge_available"
        command: "madge --circular . --exclude 'node_modules|.git'"
        purpose: "Detect circular dependencies in JavaScript/TypeScript"

      - tool: "conditional_execution"
        condition: "dependency-cruiser_available"
        command: "dependency-cruiser --validate .dependency-cruiser.js src/"
        purpose: "Advanced dependency rule validation"

  validation_reporting:
    description: "Generate comprehensive validation report"
    operations:
      - tool: "mcp_cognitive_tools_arango_modify"
        operation: "insert"
        collection: "metrics"
        document:
          type: "validation_report"
          timestamp: "{{current_timestamp}}"
          dependency_analysis:
            mapper_results: "{{dependency_mapper_output}}"
            circular_dependencies_found: "{{madge_circular_results}}"
            rule_validation_status: "{{dependency_cruiser_results}}"
          change_impact:
            files_affected: "{{impact_analysis_results}}"
            breaking_changes_detected: "{{breaking_change_analysis}}"
            recommendations: "{{validation_recommendations}}"

success_criteria:
  - dependency_map_generated
  - change_impact_analyzed
  - circular_dependencies_checked
  - validation_report_stored

# AUTOMATIC TRIGGERS (Operationalized)
auto_triggers:
  - on_file_change: ["*.md", "*.mdc", "*.yml", "*.yaml", "*.py", "*.js", "*.ts"]
  - on_protocol_update: "automatic"
  - on_rule_modification: "automatic"
  - pre_commit_hook: "optional"
